<h2>Running ZMap directly from GFF file(s)</h2>
<h3>Synopsis</h3>
<p>The aim is to run ZMap from canned data with little or no configuration - download the distribution, run configure and make then feed in your own data, typically with a command like these:
<pre>
cd my_project; zmap *.gff
zmap  ~/data/fatmouse/models.gff ~/data/fatmouse/fatmouse_psl.gff
</pre>
</p>

<p> If ZMap is run with file arguments and no configuration files or directories are specified (--conf_file=, --conf_dir=) then it will operate without the main configuration or styles files (which are specified in the configuration file).
If a configuration file is specified then this may include data sources and files need not be specified.  However, additional data files may be given and added to the session as command line arguements.  A menu option (File/Open) will allow new GFF data to be read in OTF.  (NOTE we may also later provide File/Open on the main window to choose a session).
</p>
<p>ZMap will also provide an option (File/Save As) to save the current session in a single configuration file, although the format of this will differ slightly from the existing.  All styles used will be added to the main configuration file, and data sources also, as a list of files.  If started from such a file ZMap will allow updates to be saved (File/Save) eg to store extra data files and different choices of display style.  A configuration option will be set to choose this behaviour - otterlace sessions for example may not be modified OTF, as the state is driven from Otterlace.  Unsetting this option manually will revert to a traditional session.
</p>
<p>To use Blixem it will be necessary to provide configuration manually (at least in the first release).
</p>

<p>Sensible defaults will be chosen for parameters in the [ZMap] and [ZmapWindow] stanzas. [glyphs] will be defaulted to current configuration if no [glyphs] config stanza is found (or no config file), otherwise they must all be defined.
</p>




<h3>Column Ordering</h3>
<p>This can be handled by default quite simply, using the existing forward and reverse strand (mirror) model and placing columns left to right in the order of assembly, transcripts, alignments, graphs, basic.  However this is likely to put some columns out of place eg curated features aka PolyA etc which appear to be wanted next to transcripts.
</p>
<p>In Havana there is a requirement to have the same config for the whole team but for wider use this is not so clear and it seems likely that there will be a desire to re-order columns via drag and drop and to remember session details (there have been requests for this from Havana (RT 67466, 205085).
</p>
<p>It also seems likely that if each user has thier own preferences then they may want these to apply across different sessions, which implies keeping a configuration file per user (eg in the home directory)
</p>
<p>These last two items will not be addressed in the first release.
</p>

<h4>Column configuration</h4>
<p>This involves mapping featuresets to columns, choice of styles, and various other things such as pretty names and  descriptions.  Note that if we assume that users will simply load data from file there is no need for a load columns dialog and no need to specify load on startup or otherwise.  File servers have to be 'created' automatically without configuration.
</p>
<p> Some columns consist of several sources (eg repeatmasker, curated features) and these can't be set up without external configuration, and without this we would have these appearing in several columns, not necessarily next to each other.  This is obviously poor and also uses up pointless amounts of screen real-estate.  One way to allow users to set this up would be to allow drag and drop to order columns and then menu options/ keyboard shortcuts to merge or split columns.
(not in the first release).
</p>



<h3>Default Styles</h3>
<p>These can sensibly be created for the different style modes, and alternate colours generated for new columns automatically from a hard coded palette, perhaps triggering off a string in the data featureset name (eg EST is purple).
There is an obvious need to allow user choice of colours via the usual dialog, and this implies remembering this information, which implies a session configuration file as above.
</p>

<h4>Useful styles</h4>
<p>ZMap displays some data on the forward strand only and there is no obvious way to choose this.  Some alignments are displayed gapped (alignments) when bumped and some always (ditags, BAM). In this context a default style is just a mechanism for ensuring that data is visible and then we expect users to customise.  ZMap can provide a number of optional styles per mode and these could be chosen via a style menu, which allows a naive user to set up sensible display of most data sources.
</p>
<p>If a session is saved then the chosen styles can be modified manually if more control is needed. To avoid complicated code handling style inheritance (and to keep things simple for the user) we will adopt the follwoing strategy:
<ul>
<li> Default styles will be assigned to featuresets according to style mode and feature type.
<li> A single (hard coded) base/ default style per style mode will be defined and optional styles defined by inheritance.
<li> Styles as used in ZMap will be as copied from the hard coded defaults; if a confguration file is saved and styles modifed these will replace the hard coded defaults.
<li> Styles that are deleted by the user may be replaced by hard coded defaults if still referenced.
</ul>
</p>



<h5>Servers and styles</h5>
<p>It's silly having to pass the same styles file to 40 servers in config and also via the server protocol. We should have the option of a global styles file and allow it to be removed via 'stylesfile=' in the acedb server config for example.  Although this applies to a traditional ZMap sessions, we should be able to pass a styles hash to a server instead of a file name and this will be necessary for autoconfigured file servers.
</p>


<h4>Work needed</h4>
<p>
<ul>
<li> cope with single configuration file
<li> autoconfigure columns from GFF file
<li> hard code basic styles and allocate colours
<li> style menu for column/ featureset
<li> allow 'save as' for session config, which can then be edited manually
</ul>
Then possibly:
<ul>
<li> drag and drop to position and join columns
<li> colour dialog to override default styles (can be saved as session)
</ul>
</p>


